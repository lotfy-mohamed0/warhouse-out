(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8782],{2932:function(e,t,s){Promise.resolve().then(s.bind(s,9023))},7907:function(e,t,s){"use strict";var i=s(5313);s.o(i,"useRouter")&&s.d(t,{useRouter:function(){return i.useRouter}})},9023:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return d}});var i=s(3827),n=s(4090),r=s(7907),c=s(7908),a=s(1555),l=s(3411),o=s.n(l);function d(){let e=(0,r.useRouter)(),[t,s]=(0,n.useState)([]),[l,d]=(0,n.useState)(!1);(0,n.useEffect)(()=>{c.Z.get("".concat(a.Z,"/Dashboard/missing-products")).then(e=>{s(e.data)}).catch(e=>{d(!0),o().fire({icon:"error",title:"حدث خطأ ما اثناء جلب البيانات",showConfirmButton:!1,timer:800})})},[]);let[h,m]=(0,n.useState)("");(0,n.useEffect)(()=>{""==h&&c.Z.get("".concat(a.Z,"/Dashboard/missing-products")).then(e=>{s(e.data)}).catch(e=>{d(!0),o().fire({icon:"error",title:"حذث خطأ ما اثناء جلب البيانات",showConfirmButton:!1,timer:800})})},[h]);let[u,x]=(0,n.useState)([]),[p,f]=(0,n.useState)(!1),j=(0,n.useRef)(),g=e=>{p&&(f(!1),x(u.filter(t=>t!==e))),u.includes(e)?x(u.filter(t=>t!==e)):x([...u,e])},[b,N]=(0,n.useState)({id:"",name:"",productId:"",expiryDate:"",reasonOfMissing:""}),[v,y]=(0,n.useState)(!1),[k,C]=(0,n.useState)(!1),D=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e?(N(e),C(!0)):(N({id:"",name:"",productId:"",expiryDate:"",reasonOfMissing:""}),C(!1)),y(!0)},w=()=>{y(!1)},[S,I]=(0,n.useState)(!1),M=e=>{let{name:t,value:s}=e.target;"productId"===t&&""!=s&&c.Z.get("".concat(a.Z,"/Product/ProductById?id=").concat(s)).then(e=>{N(t=>{var s,i;return{...t,name:e.data.name,expiryDate:null===(i=e.data.productDatesDto[0])||void 0===i?void 0:null===(s=i.expiryDate)||void 0===s?void 0:s.slice(0,10)}}),I(!1)}).catch(e=>{I(!0),N(e=>({...e,name:"",expiryDate:""}))}),N(e=>({...e,[t]:s}))},Z=e=>{o().fire({title:"تأكيد",text:"هل تريد حذف هذا العنصر؟",icon:"warning",showCancelButton:!0,confirmButtonText:"نعم، احذف!",cancelButtonText:"إلغاء"}).then(i=>{i.isConfirmed&&(c.Z.delete("".concat(a.Z,"/Dashboard/delete-missing-product/").concat(e)).then(i=>{o().fire({icon:"success",title:"تم الحذف بنجاح",showConfirmButton:!1,timer:800}),setTimeout(()=>{s(t.filter(t=>t.id!==e))},400)}).catch(e=>{o().fire({icon:"error",title:"حدث خطأ ما اثناء الحذف",showConfirmButton:!1,timer:800})}),w())})};return(0,n.useEffect)(()=>{var e=document.getElementById("selectAll-input");e.checked&&(e.checked=!1),document.querySelectorAll("#checkbox-item").forEach(e=>{e.checked&&(e.checked=!1)})},[t]),(0,i.jsxs)("div",{className:"table",children:[(0,i.jsxs)("div",{className:"container",children:[(0,i.jsxs)("div",{className:"header",children:[(0,i.jsxs)("div",{className:"head-box",children:[(0,i.jsx)("div",{className:"add-head",children:(0,i.jsx)("p",{onClick:()=>D(),className:"add-item",children:"إضافة منتج تالف"})}),(0,i.jsx)("div",{className:"add-head-print",onClick:()=>{if(0===u.length){o().fire({icon:"warning",title:"الرجاء تحديد عناصر للطباعة",showConfirmButton:!1,timer:1200});return}{let e=j.current.innerHTML,t=document.body.innerHTML;document.body.innerHTML=e,window.print(),document.body.innerHTML=t,window.location.reload()}},children:(0,i.jsx)("p",{className:"print-icon",children:(0,i.jsx)("i",{className:"fa-solid fa-print"})})})]}),(0,i.jsxs)("div",{className:"search-box has-arrow",children:[(0,i.jsxs)("form",{className:"d-flex search-top-table-form",role:"search",onSubmit:e=>{e.preventDefault(),""==h?c.Z.get("".concat(a.Z,"/Dashboard/missing-products")).then(e=>{s(e.data)}).catch(e=>{d(!0),o().fire({icon:"error",title:"حذث خطأ ما اثناء جلب البيانات",showConfirmButton:!1,timer:800})}):c.Z.get("".concat(a.Z,"/Dashboard/Search-MissingProducts?productName=").concat(h)).then(e=>{s(e.data)}).catch(e=>{o().fire({icon:"error",title:"لا يوجد نتائج",showConfirmButton:!1,timer:800})})},children:[(0,i.jsxs)("div",{className:"form-floating search-input",children:[(0,i.jsx)("input",{type:"text",className:"form-control",id:"floatingInput",placeholder:"ابحث هنا",onChange:e=>m(e.target.value),value:h}),(0,i.jsx)("label",{htmlFor:"floatingInput",children:"اسم المنتج"})]}),(0,i.jsx)("button",{className:"btn",type:"submit",children:(0,i.jsx)("i",{className:"fa-solid fa-search"})})]}),(0,i.jsx)("div",{className:"go-back-arrow",children:(0,i.jsx)("p",{onClick:()=>{e.back()},children:(0,i.jsx)("i",{className:"fa-solid fa-chevron-right"})})})]})]}),(0,i.jsx)("div",{className:"table-contant",children:(0,i.jsxs)("table",{className:"table table-striped table-hover",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{id:"head-Of-table",children:[(0,i.jsx)("th",{type:"hide",children:(0,i.jsx)("input",{type:"checkbox",checked:p,onChange:()=>{let e=document.querySelectorAll("#checkbox-item");p?(x([]),e.forEach(e=>{e.checked=!1})):(e.forEach(e=>{e.checked=!0}),x(t.map(e=>e.id))),f(!p)},id:"selectAll-input"})}),(0,i.jsx)("th",{scope:"col",type:"id",text:"ID",value:"id",children:"معرف المنتج"}),(0,i.jsx)("th",{scope:"col",children:"اسم المنتج"}),(0,i.jsx)("th",{scope:"col",children:"تاريخ الانتهاء"}),(0,i.jsx)("th",{scope:"col",children:"سبب التلف"}),(0,i.jsx)("th",{scope:"col",children:"تعديل"}),(0,i.jsx)("th",{scope:"col",children:"حذف"})]})}),(0,i.jsxs)("tbody",{children:[null==t?void 0:t.map(e=>{var t;return(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{scope:"row",children:(0,i.jsx)("div",{className:"check-box",children:(0,i.jsx)("input",{type:"checkbox",id:"checkbox-item",checked:u.includes(e.id),onChange:t=>g(e.id,t)})})}),(0,i.jsx)("th",{scope:"row",children:(0,i.jsx)("div",{className:"check-box",children:(0,i.jsx)("p",{className:"item-id",children:e.productId})})}),(0,i.jsx)("td",{className:"px-2",children:e.name}),(0,i.jsx)("td",{children:e.expiryDate.slice(0,10)}),(0,i.jsx)("td",{className:"px-2",style:{cursor:"pointer"},onClick:()=>{o().fire({icon:"info",title:"سبب التلف",text:e.reasonOfMissing})},children:(null===(t=e.reasonOfMissing)||void 0===t?void 0:t.length)>20?e.reasonOfMissing.substring(0,20)+"...":e.reasonOfMissing}),(0,i.jsx)("td",{className:"pen icon",children:(0,i.jsx)("i",{className:"fa-regular fa-pen-to-square",onClick:()=>D(e)})}),(0,i.jsx)("td",{className:"trash icon",children:(0,i.jsx)("i",{className:"fa-regular fa-trash-can",onClick:()=>Z(e.id)})})]},e.id)}),(null==t?void 0:t.length)==0&&l&&(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:"9",className:"text-center",style:{color:"#ff0000",fontSize:"1.5rem",padding:"30px 0",letterSpacing:"1px"},children:"لا يوجد بيانات"})}),(null==t?void 0:t.length)==0&&!l&&(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:"9",className:"text-center",style:{fontSize:"1.5rem",color:"#000",padding:"30px 0",letterSpacing:"1px"},children:"الرجاء الانتظار جاري تحميل البيانات ..."})})]})]})})]}),(0,i.jsx)("div",{className:"inventory-print-container",ref:j,children:(0,i.jsxs)("div",{className:"inventory-print-container",children:[(0,i.jsx)("div",{className:"print-header",children:"العملاء"}),(0,i.jsx)("div",{className:"print-table-container",children:(0,i.jsxs)("table",{className:"table table-bordered table-striped",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"معرف المنتج"}),(0,i.jsx)("th",{children:"اسم المنتج"}),(0,i.jsx)("th",{children:"تاريخ الانتهاء"}),(0,i.jsx)("th",{children:"سبب التلف"})]})}),(0,i.jsx)("tbody",{children:null==t?void 0:t.filter(e=>u.includes(e.id)).map(e=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:e.productId}),(0,i.jsx)("td",{children:e.name}),(0,i.jsx)("td",{children:e.expiryDate.slice(0,10)}),(0,i.jsx)("td",{children:e.reasonOfMissing})]},e.id))})]})}),(0,i.jsxs)("div",{className:"print-footer",children:["\xa9 ",new Date().getFullYear()," تقرير المخزون"]})]})}),v&&(0,i.jsx)("div",{className:"modal show d-block modal-client-form-edit-add",style:{backgroundColor:"rgba(0, 0, 0, 0.5)"},children:(0,i.jsx)("div",{className:"modal-dialog modal-dialog-centered",children:(0,i.jsxs)("div",{className:"modal-content",children:[(0,i.jsxs)("div",{className:"modal-header",children:[(0,i.jsx)("button",{type:"button",className:"close btn",onClick:w,children:(0,i.jsx)("i",{className:"bi bi-x-lg"})}),(0,i.jsx)("h5",{className:"modal-title",children:k?"تعديل":"إضافة منتج تالف"})]}),(0,i.jsx)("div",{className:"modal-body",children:(0,i.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),k){let e={name:b.name,productId:b.productId,expiryDate:b.expiryDate,reasonOfMissing:b.reasonOfMissing};c.Z.put("".concat(a.Z,"/Dashboard/update-missing-product"),e).then(e=>{s(t.map(e=>e.id==b.id?b:e)),o().fire({icon:"success",title:"تم التعديل بنجاح",showConfirmButton:!1,timer:800})}).catch(e=>{o().fire({icon:"error",title:"حذث خطأ ما اثناء التعديل",showConfirmButton:!1,timer:800})})}else{let e={name:b.name,productId:b.productId,expiryDate:b.expiryDate,reasonOfMissing:b.reasonOfMissing};b.id=t.length+1,c.Z.post("".concat(a.Z,"/Dashboard/add-missing-product"),e).then(e=>{c.Z.get("".concat(a.Z,"/Dashboard/missing-products")).then(e=>{s(e.data)}).catch(e=>{d(!0)}),o().fire({icon:"success",title:"تمت الإضافة بنجاح",showConfirmButton:!1,timer:800})}).catch(e=>{o().fire({icon:"error",title:"حدث خطأ ما اثناء الإضافة",showConfirmButton:!1,timer:800})})}w()},className:"rowa",children:[!k&&(0,i.jsx)("div",{className:"col-12",children:(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"productId",children:"معرف المنتج"}),(0,i.jsx)("input",{type:"number",className:"form-control",id:"productId",name:"productId",value:b.productId,onChange:M,required:!0})]})}),S&&(0,i.jsx)("div",{className:"col-12",children:(0,i.jsxs)("div",{className:"alert alert-danger",role:"alert",style:{padding:"5px",fontWeight:"bold"},children:["لايوجد منتج بهذا المعرف ",b.productId]})}),(0,i.jsx)("div",{className:"col-12",children:(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"name",children:"اسم المنتج"}),(0,i.jsx)("input",{type:"text",className:"form-control",id:"name",name:"name",value:b.name,onChange:M,required:!0})]})}),(0,i.jsx)("div",{classproductId:"col-12",children:(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"expiryDate",children:"تاريخ الانتهاء"}),(0,i.jsx)("input",{type:"date",className:"form-control",id:"expiryDate",name:"expiryDate",value:b.expiryDate,onChange:M,required:!0})]})}),(0,i.jsx)("div",{className:"col-12",children:(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"reasonOfMissing",children:"سبب التلف"}),(0,i.jsx)("textarea",{className:"form-control",id:"reasonOfMissing",name:"reasonOfMissing",value:b.reasonOfMissing,onChange:M,required:!0})]})}),(0,i.jsx)("div",{className:"col-lg-12 mb-3",children:(0,i.jsx)("button",{type:"submit",className:"btn btn-primary",children:k?"تحديث":"إضافة"})})]})})]})})})]})}},1555:function(e,t,s){"use strict";s.d(t,{f:function(){return i}});let i=s(8620).Buffer.from("".concat("11190013",":").concat("60-dayfreetrial"),"utf8").toString("base64");t.Z="http://16.24.26.228:8080/api"}},function(e){e.O(0,[9461,7908,2971,8069,1744],function(){return e(e.s=2932)}),_N_E=e.O()}]);